var data = [
  {
    language: "Afrikaans",
    x: -47.9,
    y: 93.2,
    geo: 6,
    family: 5,
    happiness: 15.9,
    countries: "South Africa | Namibia",
    lang_written: "Afrikaans",
    unique_word_per_lang: "Hope",
    unique_lang_per_word: "Life",
    main_country: "South-Africa"
  },
  {
    language: "Albanian",
    x: 11,
    y: 58.4,
    geo: 5,
    family: 8,
    happiness: 36.8,
    countries: "Albania | Kosovo | Macedonia | Serbia",
    lang_written: "shqip",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Albania"
  },
  {
    language: "Amharic",
    x: 68.4,
    y: -123,
    geo: 6,
    family: 12,
    happiness: 26.7,
    countries: "Ethiopia",
    lang_written: "ኣማርኛ",
    unique_word_per_lang: "Power",
    unique_lang_per_word:
      "Hostility | Aversion | Alienation | Power | Impulsiveness",
    main_country: "Ethiopia"
  },
  {
    language: "Arabic",
    x: 90.5,
    y: 39.5,
    geo: 6,
    family: 12,
    happiness: 23.8,
    countries: "Egypt | Isarel | more than 30 other countries...",
    lang_written: "العربية",
    unique_word_per_lang: "Blessed",
    unique_lang_per_word: "Fulfillment | Blessed",
    main_country: "Egypt"
  },
  {
    language: "Armenian",
    x: 52.2,
    y: -43.8,
    geo: 7,
    family: 8,
    happiness: 25.7,
    countries: "Armenia | Azerbaijan | Georgia | Iraq | Lebanon | Syria",
    lang_written: "Հայերեն",
    unique_word_per_lang: "Calm",
    unique_lang_per_word: "Calm | Forgiveness | Creativity",
    main_country: "Aremina"
  },
  {
    language: "Azeri",
    x: 43,
    y: -128,
    geo: 7,
    family: 9,
    happiness: 0,
    countries: "Azerbaijan | Turkey",
    lang_written: "Азәрбајҹан дили",
    unique_word_per_lang: "Acceptance",
    unique_lang_per_word: "Acceptance",
    main_country: "Azerbaijan"
  },
  {
    language: "Bengali",
    x: -45.4,
    y: -198,
    geo: 9,
    family: 11,
    happiness: 38.4,
    countries: "Bangladesh | India",
    lang_written: "বাংলা",
    unique_word_per_lang: "Worry",
    unique_lang_per_word: "Jealousy | Loyalty | Worry",
    main_country: "Bangladesh"
  },
  {
    language: "Catalan",
    x: 32.6,
    y: 97.9,
    geo: 2,
    family: 7,
    happiness: 0,
    countries: "Andorra | Spain | France",
    lang_written: "català",
    unique_word_per_lang: "Mercy",
    unique_lang_per_word: "Mercy",
    main_country: "Andorra"
  },
  {
    language: "Croatian",
    x: -16.2,
    y: 46.3,
    geo: 5,
    family: 2,
    happiness: 30.2,
    countries: "Croatia | Austria | Bosnia and Herzegovina | Serbia | Slovenia",
    lang_written: "Hrvatski",
    unique_word_per_lang: "Affection",
    unique_lang_per_word: "Affection",
    main_country: "Croatia"
  },
  {
    language: "Czech",
    x: -8.18,
    y: 13,
    geo: 5,
    family: 1,
    happiness: 27.3,
    countries: "Czech Republic | Croatia",
    lang_written: "čeština",
    unique_word_per_lang: "Joy",
    unique_lang_per_word: "",
    main_country: "Czech-Republic"
  },
  {
    language: "Danish",
    x: -96.4,
    y: 35.9,
    geo: 3,
    family: 4,
    happiness: 32.7,
    countries: "Denmark | Faroe Islands | Greenland | Germany",
    lang_written: "dansk",
    unique_word_per_lang: "Hope",
    unique_lang_per_word: "Hope",
    main_country: "Denmark"
  },
  {
    language: "Dutch",
    x: -61.4,
    y: 111,
    geo: 2,
    family: 5,
    happiness: 35.3,
    countries: "Netherlands | Belgium | Indonesia | Suriname",
    lang_written: "Nederlands",
    unique_word_per_lang: "Success",
    unique_lang_per_word: "Pressure",
    main_country: "Netherlands"
  },
  {
    language: "English",
    x: -69.1,
    y: 26.8,
    geo: 3,
    family: 4,
    happiness: 25.18,
    countries:
      "USA | Australia | United Kingdom | more than 80 other countries...",
    lang_written: "English",
    unique_word_per_lang: "Love",
    unique_lang_per_word: "Love",
    main_country: "USA - England - Australia"
  },
  {
    language: "Estonian",
    x: 7.72,
    y: 40.9,
    geo: 4,
    family: 10,
    happiness: 17.9,
    countries: "Estonia",
    lang_written: "eesti keel",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Estonia"
  },
  {
    language: "Finnish",
    x: -32.5,
    y: -109,
    geo: 3,
    family: 10,
    happiness: 31.3,
    countries: "Finland | Norway | Sweden",
    lang_written: "suomi",
    unique_word_per_lang: "Habit",
    unique_lang_per_word: "Frustration",
    main_country: "Finland"
  },
  {
    language: "French",
    x: 36.9,
    y: 171,
    geo: 2,
    family: 7,
    happiness: 30.4,
    countries: "France | Canada | Morocco | more than 40 other countries...",
    lang_written: "français",
    unique_word_per_lang: "Evil",
    unique_lang_per_word: "",
    main_country: "France"
  },
  {
    language: "Georgian",
    x: 19.6,
    y: -115,
    geo: 7,
    family: 3,
    happiness: 31.1,
    countries: "Georgia",
    lang_written: "ქართული",
    unique_word_per_lang: "Desire",
    unique_lang_per_word: "Desire",
    main_country: "Georgia"
  },
  {
    language: "Greek",
    x: 111,
    y: -131,
    geo: 5,
    family: 8,
    happiness: 23.6,
    countries: "Greece | Albania | Cyprus",
    lang_written: "ελληνικά",
    unique_word_per_lang: "Joy",
    unique_lang_per_word: "Flamboyance | Destruction",
    main_country: "Greece"
  },
  {
    language: "Hebrew",
    x: -1.01,
    y: 97.9,
    geo: 6,
    family: 12,
    happiness: 28.8,
    countries: "Israel",
    lang_written: "עברית",
    unique_word_per_lang: "Friendship",
    unique_lang_per_word: "Friendship",
    main_country: "Israel"
  },
  {
    language: "Hindi",
    x: -24.6,
    y: -192,
    geo: 9,
    family: 11,
    happiness: 29.2,
    countries: "India | Guyana | Trinidad and Tobago | United Arab Emirates",
    lang_written: "हिन्दी",
    unique_word_per_lang: "Secured",
    unique_lang_per_word:
      "Insult | Desperation | Fear | Empathy | Anxiety | Distress | Secured | Routine",
    main_country: "India"
  },
  {
    language: "Hungarian",
    x: -47.3,
    y: -58.7,
    geo: 5,
    family: 10,
    happiness: 26.4,
    countries:
      "Hungary | Austria | Croatia | Romania | Serbia | Slovakia | Ukraine",
    lang_written: "magyar",
    unique_word_per_lang: "Sorry",
    unique_lang_per_word: "",
    main_country: "Hungary"
  },
  {
    language: "Icelandic",
    x: -54.5,
    y: 6.71,
    geo: 3,
    family: 4,
    happiness: 31.1,
    countries: "Iceland",
    lang_written: "Íslenska",
    unique_word_per_lang: "Fun",
    unique_lang_per_word: "Fun",
    main_country: "Iceland"
  },
  {
    language: "Indonesian",
    x: 23.8,
    y: -52,
    geo: 10,
    family: 14,
    happiness: 35.7,
    countries: "Indonesia",
    lang_written: "Bahasa Indonesia",
    unique_word_per_lang: "Love",
    unique_lang_per_word: "",
    main_country: "Indonesia"
  },
  {
    language: "Italian",
    x: 104,
    y: 90.3,
    geo: 2,
    family: 7,
    happiness: 28.1,
    countries:
      "Italy | Argentina | Croatia | Libya | Monaco | San Marino | Somalia | Switzerland | Vatican City",
    lang_written: "italiano",
    unique_word_per_lang: "Hurt",
    unique_lang_per_word: "Hurt",
    main_country: "Italy"
  },
  {
    language: "Japanese",
    x: 28.6,
    y: -72.6,
    geo: 10,
    family: 15,
    happiness: 28.3,
    countries: "Japan | Marshall Islands | Palau",
    lang_written: "日本語",
    unique_word_per_lang: "Power",
    unique_lang_per_word: "Satisfaction | Tiredness",
    main_country: "Japan"
  },
  {
    language: "Kazakh",
    x: -4.42,
    y: -116,
    geo: 7,
    family: 9,
    happiness: 19.1,
    countries: "Kazakhstan",
    lang_written: "Қазақ тілі",
    unique_word_per_lang: "Soul",
    unique_lang_per_word: "",
    main_country: "Kazakhstan"
  },
  {
    language: "Khmer",
    x: 56,
    y: -159,
    geo: 9,
    family: 11,
    happiness: 25.6,
    countries: "Cambodia | Vietnam",
    lang_written: "ភាសាខ្មែរ",
    unique_word_per_lang: "Emotion",
    unique_lang_per_word: "Emotion | Nervousness | Activism",
    main_country: "Cambodia"
  },
  {
    language: "Korean",
    x: -7.16,
    y: -13.1,
    geo: 10,
    family: 15,
    happiness: 24.8,
    countries: "South Korea | North Korea",
    lang_written: "한국어",
    unique_word_per_lang: "Dream",
    unique_lang_per_word:
      "Suicide | Laughter | Emptiness | Exhaustion | Sorry | Dream",
    main_country: "South-Korea"
  },
  {
    language: "Latvian",
    x: 72.5,
    y: -12.3,
    geo: 4,
    family: 1,
    happiness: 17.1,
    countries: "Latvia",
    lang_written: "latviešu valoda",
    unique_word_per_lang: "Pleasure",
    unique_lang_per_word:
      "Pleasure | Joy | Astonishment | Laziness | Comradeship",
    main_country: "Latvia"
  },
  {
    language: "Lithuanian",
    x: 57,
    y: -24.7,
    geo: 4,
    family: 1,
    happiness: 21,
    countries: "Lithuania | Latvia",
    lang_written: "lietuvių kalba",
    unique_word_per_lang: "hope",
    unique_lang_per_word: "",
    main_country: "Lithuania"
  },
  {
    language: "Macedonian",
    x: 40.4,
    y: 12.4,
    geo: 5,
    family: 2,
    happiness: 23.4,
    countries: "Macedonia",
    lang_written: "македонски",
    unique_word_per_lang: "Kindness",
    unique_lang_per_word: "Kindness",
    main_country: "Macedonia"
  },
  {
    language: "Malaysian",
    x: -8.38,
    y: -59.8,
    geo: 10,
    family: 14,
    happiness: 30.3,
    countries: "Malaysia | Brunei | Singapore",
    lang_written: "Melayu",
    unique_word_per_lang: "Love",
    unique_lang_per_word:
      "Shame | Dismay | Passion | Optimism | Enthusiasm | Shyness",
    main_country: "Malaysia"
  },
  {
    language: "Nepali",
    x: -3.08,
    y: -189,
    geo: 9,
    family: 11,
    happiness: 30.5,
    countries: "Nepal",
    lang_written: "नेपाली",
    unique_word_per_lang: "Secured",
    unique_lang_per_word: "Integrity",
    main_country: "Nepal"
  },
  {
    language: "Norwegian",
    x: -108,
    y: 55.9,
    geo: 3,
    family: 4,
    happiness: 36.8,
    countries: "Norway",
    lang_written: "norsk",
    unique_word_per_lang: "Faith",
    unique_lang_per_word: "faith",
    main_country: "Norway"
  },
  {
    language: "Persian",
    x: 88.5,
    y: -140,
    geo: 8,
    family: 9,
    happiness: 24,
    countries: "Iran | Afghanistan | United Arab Emirates",
    lang_written: "فارسى",
    unique_word_per_lang: "Activism",
    unique_lang_per_word: "Melancholy",
    main_country: "Iran"
  },
  {
    language: "Polish",
    x: 46.4,
    y: -9.06,
    geo: 4,
    family: 1,
    happiness: 27.5,
    countries: "Poland | Lithuania | Ukraine",
    lang_written: "polski",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Poland"
  },
  {
    language: "Portuguese_Brazil",
    x: 42.3,
    y: 131,
    geo: 1,
    family: 7,
    happiness: 34.3,
    countries: "Brazil | Portugal | more than 15 other countries...",
    lang_written: "português",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Brazil"
  },
  {
    language: "Portuguese_Europe",
    x: 36,
    y: 145,
    geo: 2,
    family: 7,
    happiness: 24.8,
    countries: "Portugal | Brazil | more than 15 other countries...",
    lang_written: "português",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Portugal"
  },
  {
    language: "Romanian",
    x: 46.5,
    y: 192,
    geo: 5,
    family: 7,
    happiness: 28.8,
    countries: "Romania | Moldova | Serbia | Ukraine",
    lang_written: "român",
    unique_word_per_lang: "Evil",
    unique_lang_per_word: "Evil | Soul | Trust | Success | Longing | Madness",
    main_country: "Romania"
  },
  {
    language: "Russian",
    x: 65.8,
    y: 132,
    geo: 8,
    family: 3,
    happiness: 18.7,
    countries: "Russia | Ukraine | more than 20 other countires...",
    lang_written: "Русский язык",
    unique_word_per_lang: "Love",
    unique_lang_per_word: "",
    main_country: "Russia"
  },
  {
    language: "Sinhala",
    x: 76.2,
    y: -75,
    geo: 9,
    family: 13,
    happiness: 33.8,
    countries: "Sri Lanka",
    lang_written: "සිංහල",
    unique_word_per_lang: "Power",
    unique_lang_per_word: "",
    main_country: "Sri-Lanka"
  },
  {
    language: "Slovak",
    x: 15.3,
    y: 79,
    geo: 5,
    family: 1,
    happiness: 28.2,
    countries: "Slovakia | Croatia | Serbia",
    lang_written: "slovenčina",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Slovakia"
  },
  {
    language: "Slovenian",
    x: -47.9,
    y: 72,
    geo: 5,
    family: 2,
    happiness: 24.6,
    countries: "Slovenia",
    lang_written: "slovenščina",
    unique_word_per_lang: "Pride",
    unique_lang_per_word: "",
    main_country: "Slovenia"
  },
  {
    language: "Spanish_South_America",
    x: -18,
    y: 160,
    geo: 1,
    family: 7,
    happiness: 35.2,
    countries: "Argentina | Spain | more than 60 other countries...",
    lang_written: "español",
    unique_word_per_lang: "Evil",
    unique_lang_per_word: "",
    main_country: "Argentina"
  },
  {
    language: "Spanish_Spain",
    x: -14.3,
    y: 174,
    geo: 2,
    family: 7,
    happiness: 36,
    countries: "Spain | Argentina | more than 60 other countries...",
    lang_written: "español",
    unique_word_per_lang: "Evil",
    unique_lang_per_word: "",
    main_country: "Spain"
  },
  {
    language: "Swahili",
    x: 96.1,
    y: -164,
    geo: 6,
    family: 0,
    happiness: 22.2,
    countries: "Burundi | Comoros | Kenya | Rwanda | Tanzania | Uganda",
    lang_written: "Kiswahili",
    unique_word_per_lang: "Fairness",
    unique_lang_per_word:
      "Fairness | Ambition | Praise | Pessimism | Ethics | Panic | Failure",
    main_country: "Africa"
  },
  {
    language: "Swedish",
    x: -112,
    y: 18.3,
    geo: 3,
    family: 4,
    happiness: 28,
    countries: "Sweden | Finland",
    lang_written: "svenska",
    unique_word_per_lang: "Hope",
    unique_lang_per_word: "",
    main_country: "Sweeden"
  },
  {
    language: "Tagalog",
    x: 40,
    y: 64,
    geo: 10,
    family: 14,
    happiness: 35,
    countries: "Philippines",
    lang_written: "Tagalog",
    unique_word_per_lang: "Fun",
    unique_lang_per_word: "Wrath",
    main_country: "Philippines"
  },
  {
    language: "Turkish",
    x: -69.6,
    y: -73.5,
    geo: 7,
    family: 9,
    happiness: 26.4,
    countries: "Turkey | Romania | Cyprus | Iran | Kosovo | Macedonia | Iraq",
    lang_written: "Türkçe",
    unique_word_per_lang: "Acceptance",
    unique_lang_per_word: "Hate | Terror | Nerve | Curiosity",
    main_country: "Turkey"
  },
  {
    language: "Ukrainian",
    x: 69.1,
    y: 40,
    geo: 4,
    family: 3,
    happiness: 26.4,
    countries: "Ukraine | Slovakia | Croatia | Poland |",
    lang_written: "Українська",
    unique_word_per_lang: "Life",
    unique_lang_per_word: "",
    main_country: "Ukraine"
  },
  {
    language: "Urdu",
    x: 126,
    y: 84.5,
    geo: 9,
    family: 11,
    happiness: 31.5,
    countries:
      "Pakistan | Bahrain | Guyana | India | Oman | United Arab Emirates",
    lang_written: "اردو",
    unique_word_per_lang: "Hurt",
    unique_lang_per_word: "Cruelty | Contempt",
    main_country: "Pakistan"
  },
  {
    language: "Uzbek",
    x: 99.1,
    y: -76,
    geo: 8,
    family: 9,
    happiness: 29.1,
    countries: "Uzbekistan | Turkmenistan",
    lang_written: "ўзбек тили",
    unique_word_per_lang: "Aecurity",
    unique_lang_per_word: "",
    main_country: "Uzbekistan"
  },
  {
    language: "Welsh",
    x: 86,
    y: -40.3,
    geo: 3,
    family: 6,
    happiness: 0,
    countries: "Wales | United Kingdom",
    lang_written: "Cymraeg",
    unique_word_per_lang: "Habit",
    unique_lang_per_word:
      "Disgust | Habit | Disappointment | Encouragement | Greed | Arrogance | Remorse",
    main_country: "Wales"
  }
];

var linesArr = [65, 165, 265, 365, 465, 565, 665, 765];

var cur_view = "flag";
var cur_lang = data.findIndex(d => d.language == "English");

var marginMap = { top: 125, right: 370, bottom: 40, left: 20 };
var marginInfo = { top: 125, right: 20, bottom: 40, left: 20 };
var widthMap = window.innerWidth - marginMap.right - marginMap.left;
var heightMap = window.innerHeight - marginMap.top - marginMap.bottom;
var widthInfo = widthMap / 3;
var xScale = d3
  .scaleLinear()
  .domain([d3.min(data, d => d.x), d3.max(data, d => d.x)]);
var yScale = d3
  .scaleLinear()
  .domain([d3.min(data, d => d.y), d3.max(data, d => d.y)]);
var happyScale = d3
  .scaleLinear()
  .domain([d3.min(data, d => d.happiness), d3.max(data, d => d.happiness)]);
xScale.range([50, widthMap - 80]);
yScale.range([50, heightMap - 80]);
happyScale.range([0, 100]);
function updateWindowSize() {
  widthMap = window.innerWidth - marginMap.right - marginMap.left;
  heightMap = window.innerHeight - marginMap.top - marginMap.bottom;
  widthInfo = widthMap / 3;
}
window.addEventListener("resize", updateWindowSize);
updateWindowSize();

var bodySelect = d3.select("body").attr("id", "cont");

var boxesContainer = bodySelect
  .append("div")
  .attr("id", "diva")
  .style("display", "flex")
  .style("justify-content", "space-around");

var toolBar = bodySelect.append("nav").attr("id", "toolBar");

toolBar.append("a").attr("class", "Logo buttonDesign");

toolBar
  .append("input")
  .attr("class", "buttonDesign active")
  .attr("id", "flagButton")
  .attr("type", "button")
  .attr("value", "Flags")
  .on("click", _ => {
    onButton("flag");
  });

toolBar
  .append("input")
  .attr("class", " buttonDesign")
  .attr("id", "geoButton")
  .attr("type", "button")
  .attr("value", "Geographic")
  .on("click", _ => {
    onButton("geo");
  });

toolBar
  .append("input")
  .attr("class", " buttonDesign")
  .attr("id", "familyButton")
  .attr("type", "button")
  .attr("value", "Languages Evolution")
  .on("click", _ => {
    onButton("family");
  });

toolBar
  .append("input")
  .attr("class", " buttonDesign")
  .attr("id", "happinessButton")
  .attr("type", "button")
  .attr("value", "Happiness")
  .on("click", _ => {
    d3.selectAll(".happiness").style("fill", d =>
      colorGradient(happyScale(d.happiness), 0, 244)
    );
    onButton("happiness");
  });

var tip = d3
  .tip()
  .attr("class", "tipDesign")
  .offset([-6, 0])
  .html(function(d) {
    return d.language.replace("_", " ").replace("_", " ");
  });

var svgContainer = boxesContainer
  .append("svg")
  .attr("width", widthMap)
  .attr("height", heightMap)
  .attr("class", "svgContainer");

var infoContainer = boxesContainer
  .append("svg")
  .attr("class", "svgInfo")
  .attr("id", "info")
  .style("width", widthInfo)
  .style("height", heightMap);

var infoHeadline = infoContainer
  .append("text")
  .attr("class", "infoHeadline")
  .attr("x", widthInfo / 10)
  .attr("y", "80px")
  .attr("text-anchor", "left");

infoContainer
  .append("line")
  .attr("x1", widthInfo / 10)
  .attr("x2", widthInfo - 30)
  .attr("y1", "100px")
  .attr("y2", "100px")
  .attr("stroke-width", "0.06em")
  .attr("stroke", "white");

var infoLanguageName = infoContainer
  .append("text")
  .attr("class", "mostUsedWords")
  .attr("text-anchor", "end")

  .attr("x", widthInfo - 30)
  .attr("y", "125px")
  .attr("margin-right", "10px")
  // .attr("position", "relative")
  // .text(o => o.lang_written);
  .text("English");

infoContainer
  .append("text")
  .attr("class", "mostUsedWordsHeadline")
  .attr("x", widthInfo / 10)
  .attr("y", "170px")
  .attr("text-anchor", "left")
  .text("Most used words:");

var mostUsedWords = infoContainer
  .append("text")
  .attr("class", "mostUsedWords")
  .attr("x", widthInfo / 5)
  .attr("y", "220px")
  .attr("text-anchor", "left")
  .text("Word A    |     Word B     |    Word C");

// infoContainer
//   .append("text")
//   .attr("class", "mostUsedWordsHeadline")
//   .attr("x", widthInfo / 10)
//   .attr("y", "170px")
//   .attr("text-anchor", "left")
//   .text("Most used words:");
//
// infoContainer
//   .append("text")
//   .attr("class", "mostUsedWords")
//   .attr("x", widthInfo / 5)
//   .attr("y", "220px")
//   .attr("text-anchor", "left")
//   .text("Word A    |     Word B     |    Word C");
// infoContainer
//   .append("image")
//   .attr("xlink:href", "resources/amCharts.png")
//   .attr("text-anchor", "middle")
//   .attr("width", widthInfo - 30 - widthInfo / 10)
//   .attr("height", "400px");

var linesGroup = svgContainer.append("g");

var lines = linesGroup
  .selectAll("lines")
  .data(linesArr)
  .enter()
  .append("line");

lines
  .attr("x1", 30)
  .attr("x2", widthMap - 70)
  .attr("y1", o => o)
  .attr("y2", o => o)
  .attr("stroke-width", 0.9)
  .attr("stroke-dasharray", "3 8")
  .attr("stroke", "rgb(65, 64, 64)");

var circlesGroup = svgContainer
  .append("g")
  .selectAll("g")
  .data(data);

var circlesGroupEnter = circlesGroup
  .enter()
  .append("g")
  .attr("class", "circleDesign flag")
  .style("transform-origin", d => `${xScale(d.x)}px ${yScale(d.y)}px`)
  .on("mouseover", mouseOn)
  .on("mouseout", mouseOff);
circlesGroupEnter.append("circle");
circlesGroupEnter.append("image");

function render() {
  updateWindowSize();
  xScale.range([50, widthMap - 80]);
  yScale.range([50, heightMap - 80]);
  svgContainer.call(tip);

  circlesGroupEnter.attr("class", o => {
    if (cur_view == "flag") return "circleDesign flag";
    else if (cur_view == "geo") return "circleDesign geo geo" + o.geo;
    else if (cur_view == "family")
      return "circleDesign family family" + o.family;
    else if (cur_view == "happiness") return "circleDesign happiness";
  });

  var circlesAttr = circlesGroupEnter
    .select("circle")
    .attr("cx", o => xScale(o.x))
    .attr("cy", o => yScale(o.y))
    .attr("r", "1.3em");

  var flag = circlesGroupEnter
    .select("image")
    .attr("xlink:href", o => "resources/flags/" + o.language + ".png")
    .attr("text-anchor", "middle")
    .attr("x", o => xScale(o.x) - 22)
    .attr("y", o => yScale(o.y) - 22)
    .attr("width", "2.7em")
    .attr("name", o => o.language)
    .on("click", function(o) {
      index = data.findIndex(function(element) {
        return element.language == o.language;
      });
      cur_lang = index;
      renderInfo();
    });
}

function renderInfo() {
  cur_headline = data[cur_lang].language;
  if (
    cur_headline == "Spanish_Spain" ||
    cur_headline == "Spanish_South_America"
  )
    cur_headline = "Spanish";
  else if (
    cur_headline == "Portuguese_Brazil" ||
    cur_headline == "Portuguese_Europe"
  )
    cur_headline = "Portuguese";
  infoHeadline.text(cur_headline);
  infoLanguageName.text(capitalizeFirstLetter(data[cur_lang].lang_written));
  mostUsedWords.text(data[cur_lang].unique_word_per_lang);
}

function renderLoad() {
  render();
  renderInfo();
}

function mouseOn(d) {
  tip.show(d);
}

function mouseOff(d) {
  tip.hide(d);
}

function onButton(view) {
  cur_view = view;
  document.getElementById(view + "Button").className = "buttonDesign active";
  if (view != "flag") {
    document.getElementById("flagButton").className = "buttonDesign";
  }
  if (view != "geo") {
    document.getElementById("geoButton").className = "buttonDesign";
  }
  if (view != "family") {
    document.getElementById("familyButton").className = "buttonDesign";
  }
  if (view != "happiness") {
    document.getElementById("happinessButton").className = "buttonDesign";
  }
  render();
}

function capitalizeFirstLetter(string) {
  return string.charAt(0).toUpperCase() + string.slice(1);
}

var map = AmCharts.makeChart("mapFrame", {
  type: "map",
  theme: "dark",
  projection: "mercator",
  panEventsEnabled: true,
  backgroundColor: "#535364",
  backgroundAlpha: 1,
  zoomControl: {
    zoomControlEnabled: false
  },
  dataProvider: {
    map: "worldHigh",
    getAreasFromMap: true,
    areas: [
      {
        id: "BE",
        showAsSelected: true
      },
      {
        id: "BA",
        showAsSelected: true
      },
      {
        id: "BG",
        showAsSelected: true
      }
    ]
  },
  areasSettings: {
    autoZoom: true,
    color: "#B4B4B7",
    colorSolid: "#84ADE9",
    selectedColor: "#84ADE9",
    outlineColor: "#666666",
    rollOverColor: "#9EC2F7",
    rollOverOutlineColor: "#000000"
  }
});

//   linearGradient
//     .selectAll("stop")
//     .data([
//       { offset: "0%", color: "#2c7bb6" },
//       { offset: "12.5%", color: "#00a6ca" },
//       { offset: "25%", color: "#00ccbc" },
//       { offset: "37.5%", color: "#90eb9d" },
//       { offset: "50%", color: "#ffff8c" },
//       { offset: "62.5%", color: "#f9d057" },
//       { offset: "75%", color: "#f29e2e" },
//       { offset: "87.5%", color: "#e76818" },
//       { offset: "100%", color: "#d7191c" }
//     ])

// <div id="mapdiv" style="width: 1000px; height: 450px;" />;

/**
 * You may use this function with both 2 or 3 interval colors for your gradient.
 * For example, you want to have a gradient between Bootstrap's danger-warning-success colors.
 */
function colorGradient(fadeFraction, rgbColor1, rgbColor2, rgbColor3) {
  var color1 = rgbColor1;
  var color2 = rgbColor2;
  var fade = fadeFraction;

  // Do we have 3 colors for the gradient? Need to adjust the params.
  if (rgbColor3) {
    fade = fade * 2;

    // Find which interval to use and adjust the fade percentage
    if (fade >= 1) {
      fade -= 1;
      color1 = rgbColor2;
      color2 = rgbColor3;
    }
  }

  var diffRed = color2.red - color1.red;
  var diffGreen = color2.green - color1.green;
  var diffBlue = color2.blue - color1.blue;

  var gradient = {
    red: parseInt(Math.floor(color1.red + diffRed * fade), 10),
    green: parseInt(Math.floor(color1.green + diffGreen * fade), 10),
    blue: parseInt(Math.floor(color1.blue + diffBlue * fade), 10)
  };

  return (
    "rgb(" + gradient.red + "," + gradient.green + "," + gradient.blue + ")"
  );
}
